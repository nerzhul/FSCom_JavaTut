package windows.window;

import java.awt.Color;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.event.ActionListener;

import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextField;
import javax.swing.JTree;
import javax.swing.tree.DefaultMutableTreeNode;
import javax.swing.tree.DefaultTreeModel;
import javax.swing.tree.TreeSelectionModel;

import windows.actions.Bouton_Changement_status;
import windows.actions.Clicks_Contact;
import windows.actions.Menu_Ajout_Contact;
import windows.actions.Menu_Ajout_Groupe;
import windows.actions.Menu_Changement_Pseudo;
import windows.actions.Menu_Deconnexion;
import windows.actions.Menu_pref;
import windows.actions.Menu_principal_apropos;
import windows.actions.Menu_principal_quit;

public class form_contact extends JFrame{

	private static final long serialVersionUID = 1L;
	protected JFrame fram;
	private JPanel pan;
	private JLabel Titre;
	private JLabel Soustitre;
	private JTree  tree;
	private String pseudo;
	private JComboBox changstatus;
	private JMenuItem quitter;
	private JMenuItem ajoutgroupe;
	private JMenuItem ajoutcontact;
	private JMenuItem changerpseudo;
	private JMenuItem deconnexion;
	private JMenuItem aPropos;
	private JMenuItem preference;
	private int status2;
	private JTextField msgperso;

	public form_contact(int stat, String pseudo2){
		this.status2=stat;
		this.pseudo=pseudo2;
		BuildFenetre();
	}

	private void BuildFenetre(){
		
		fram=new JFrame();
		fram.setTitle("Cookie Messenger - Contacts"); 
		fram.setSize(400,600); 
		fram.setLocationRelativeTo(null);
		fram.setResizable(true);
		fram.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
		
		pan=new JPanel();
		pan.setLayout(new FlowLayout());
		pan.setBackground(new Color(128,128,255));
		pan.setLayout(new FlowLayout(FlowLayout.CENTER,600,15));
		
		


		Titre=new JLabel("Vous etes connecté en tant que " + pseudo,JLabel.CENTER);
		
		changstatus= new JComboBox();
		changstatus.addItem("Offline");
		changstatus.addItem("Online");
		changstatus.addItem("Busy");
		changstatus.addItem("AFK");
		changstatus.setSelectedIndex(status2);
		changstatus.addActionListener(new Bouton_Changement_status(changstatus));
		msgperso = new JTextField(20);
		//msgperso = new JTextField(getmsgperso,20);
		
		Soustitre = new JLabel("Liste de vos contacts : ");
		
		pan.add(Titre);
		pan.add(changstatus);
		pan.add(msgperso);
		pan.add(Soustitre);
		
		setlistcontact();	
		Menu_principal();
		fram.setContentPane(pan);        
		fram.setVisible(true); 
	    
	}
	
	private void setlistcontact(){
		
		//définition de la racine
		DefaultMutableTreeNode root = new DefaultMutableTreeNode("Contacts");
		 
		// Construction des différents noeuds de l'arbre.
		DefaultMutableTreeNode groupe = new DefaultMutableTreeNode("Autres Contacts");
		root.add(groupe);
		DefaultMutableTreeNode contact = new DefaultMutableTreeNode("truc");
		groupe.add(contact);
		contact = new DefaultMutableTreeNode("truc2");
		groupe.add(contact);
		groupe = new DefaultMutableTreeNode("Amis");
		root.add(groupe);
		contact = new DefaultMutableTreeNode("truc3");
		groupe.add(contact);
		     
		// Construction du modèle de l'arbre.
		DefaultTreeModel myModel = new DefaultTreeModel(root);
		 
		// Construction de l'arbre.
		tree = new JTree(myModel);
		
		/*
		// Construction d'un afficheur par défaut.
		DefaultTreeCellRenderer myRenderer = new DefaultTreeCellRenderer();
		 
		// Changement de l'icône pour les feuilles de l'arbre.
		myRenderer.setLeafIcon(new ImageIcon("pageIcon.png"));
		// Changement de l'icône pour les noeuds fermés.
		myRenderer.setClosedIcon(new ImageIcon("closedBookIcon.png"));
		// Changement de l'icône pour les noeuds ouverts.
		myRenderer.setOpenIcon(new ImageIcon("openBookIcon.png"));
		 
		// Application de l'afficheur à l'arbre.
		myTree.setCellRenderer(myRenderer);
		*/

		tree.getSelectionModel().setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);
		tree.addMouseListener(new Clicks_Contact(tree));
		tree.setRootVisible(false);
		pan.add(tree);
		JScrollPane treeAvecAscenseur = new JScrollPane(tree);
		treeAvecAscenseur.setPreferredSize(new Dimension(150, 300));
		pan.add(treeAvecAscenseur);
	}
	
	private void Menu_principal() {
		JMenuBar menuBar = new JMenuBar();
		JMenu menu1 = new JMenu("Menu");
		JMenu menu2 = new JMenu("?");
		JMenu menu3 = new JMenu("Option");
		
		quitter= AddItem("Quitter",new Menu_principal_quit());
		ajoutcontact = AddItem("Ajouter un contact",new Menu_Ajout_Contact());
		ajoutgroupe = AddItem("Ajouter un groupe",new Menu_Ajout_Groupe());
		changerpseudo = AddItem("Changer de pseudo",new Menu_Changement_Pseudo(Titre));
		deconnexion = AddItem("Se déconnecter",new Menu_Deconnexion(fram));
		aPropos = AddItem("A propos...",new Menu_principal_apropos());
		preference = AddItem("Préférences",new Menu_pref(pan));
		
		menu1.add(deconnexion);
		menu1.add(ajoutcontact);
		menu1.add(ajoutgroupe);
		menu1.add(changerpseudo);
		menu3.add(preference);
		menu1.add(quitter);
		menu2.add(aPropos);
		
		menuBar.add(menu1);
		menuBar.add(menu3);
		menuBar.add(menu2);
		fram.setJMenuBar(menuBar);
	}
	
	private JMenuItem AddItem(String label, ActionListener obj)
	{
		JMenuItem temp = new JMenuItem(label);
		temp.addActionListener(obj);
		return temp;
		
	}
	public JPanel getPan(){
		return this.pan;
	}
}
