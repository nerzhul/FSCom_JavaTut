package windows.actions;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.PrintWriter;

import javax.swing.JCheckBox;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JPasswordField;
import javax.swing.JTextField;

import windows.window.form_fram;
import windows.window.pannel_contact;

public class Bouton_connect implements ActionListener {
	//contenuUser() et contenuPass();
	private JFrame fenetre;
	private JComboBox status;
	private JTextField username;
	private JPasswordField passwd;
	private JCheckBox sauvegarde;
	private String user;
	private String pass;
	private JFrame frame;
	public Bouton_connect(JComboBox statusco, JTextField mail, JPasswordField password, JCheckBox save, JFrame fram) {
		this.status=statusco;
		this.username=mail;
		this.passwd=password;
		this.sauvegarde=save;
		frame=fram;
	}
	
	public void actionPerformed(ActionEvent e) {

		boolean connectok=true;
		boolean save;
		save=sauvegarde.isSelected();
		user = username.getText();
		pass = new String(passwd.getPassword());
		int stat2 = status.getSelectedIndex();
		if(save==true)
		{
			savefichier();
		}
		if(connectok == true)
		{
			//verif login-->server avec user qui est le nom d'utilisateur et pass qui est le password et on récupère le pseudo dans pseudo
			((form_fram) frame).buildfenetre(2);
		}
		else{
			JOptionPane.showMessageDialog(fenetre, "Mauvais mot de passe ou mail");
		}
			
		//save fichier
	}
	
	public void savefichier(){
		String fichier ="fichier.txt";
		try {
			FileWriter fw = new FileWriter (fichier);
			BufferedWriter bw = new BufferedWriter (fw);
			PrintWriter fichierSortie = new PrintWriter (bw); 
				fichierSortie.println (user); 
				fichierSortie.println (pass); 
			fichierSortie.close();
		}
		catch (Exception e){
			System.out.println(e.toString());
		}	
	}

}
